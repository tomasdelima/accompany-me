<% content_for :page, 'edit activity' %>

<div class="col-md-10">
  <div class="box">
    <h2><%= t('activerecord.model.activity') %></h2>

    <% params[:errors].try(:each) do |error| %>
      <div class="alert alert-danger">
        <a class="close" data-dismiss="alert" href="#">×</a>
        <%= "<strong>#{error[0].capitalize}</strong>: #{error[1][0]}".html_safe %>
      </div>
    <% end %>

    <%= form_for activity do |f| %>
      <ul class="list details">
        <li>
          <%= f.label :name %>
          <%= f.text_field :name, autofocus: true, class: :input %>
        </li>

        <li>
          <%= f.label :frequency %>
          <span class="input">
            <%= f.select :frequency, ['Diário', 'Semanal', 'Bisemanal', 'Mensal', 'Trimestral', 'Anual'], {include_blank: true}, {} %>
          </span>
        </li>

        <li>
          <%= f.label :organizer %>
          <span class="input">
            <%= f.select :organizer_id, current_user.friends.map{ |f| [f.name, f.id]}, {}, {} %>
          </span>
        </li>

        <li class="date-time">
          <%= f.label :last_occurrence %>
          <span class="input">
            <%= f.datetime_select :last_occurrence, {include_blank: true} %>
          </span>
        </li>

        <li class="date-time">
          <%= f.label :last_accompanied %>
          <span class="input">
            <%= f.datetime_select :last_accompanied, {include_blank: true} %>
          </span>
        </li>

        <li class="date-time">
          <%= f.label :accompaniment_frequency %>
          <%= f.number_field :accompaniment_frequency, class: :input %>
          dias
        </li>

        <li>
          <%= f.label :participants %>
          <ul class="list input">
            <% current_user.friends.each do |fr| %>
              <li>
                <%= f.check_box :participant_ids, {multiple: true, checked: @activity.participant_ids.include?(fr.id.to_i)}, fr.id, nil %>
                <%= f.label "participant_ids_#{fr.id}", fr.name, {class: 'sub-form'} %>
              </li>
            <% end %>
          </ul>
        </li>
      </ul>

      <%= f.submit class: 'btn btn-success' %>
    <% end %>
  </div>
</div>